<!doctype html>
<html lang="ko">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.ico">
    
    <title>創造和提升 (Hoisiting) | apeiros0 Blog</title>
    
    <link rel="stylesheet" href="/css/style.css">
    
    <link rel="stylesheet" href="/libs/fancybox/jquery.fancybox.css" charset="utf-8">
    
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body class="site">
    <header class="site-header">
        <h1 class="site-title"><a href="/">apeiros0 Blog</a></h1>
        <nav class="site-nav">
            <ul class="nav">
                
                <li><a href="/archives">Archives</a></li>
                
                
                <li><a class="toggle-search" href="#search">search</a></li>
            </ul>
        </nav>
        <div class="site-search" id="search">
            <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="https://apeiros0.github.io"></form>
        </div>
        
            <div class="site-header-background" style="background-image:url(http://reumia.github.io/hexo-theme-zzoman2015/images/background-zzoman2015.jpg)"></div>
        
    </header>
    <div class="site-body">
        <div class="global-width">
    <article class="article" data-layout="post" data-slug="creation_and_hoisiting">
        <div class="article-content">
            
            
            <header class="article-header">
                <div class="article-meta">
                    <a href="/JavaScript/2019/10/08/creation_and_hoisiting/" class="article-date">
  <time datetime="2019-10-07T16:00:00.000Z">2019-10-08</time>
</a>
                    
  <div class="article-category categories">
    <a class="category-link" href="/categories/JavaScript/">JavaScript</a>
  </div>

                    
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/克服-JavaScript-奇怪部分筆記/">克服 JavaScript 奇怪部分筆記</a></li></ul>

                </div>
                
    <h1 class="article-title" itemprop="name">
      <a href="/JavaScript/2019/10/08/creation_and_hoisiting/">創造和提升 (Hoisiting)</a>
    </h1>

            </header>
            
            <div class="article-body">
                <p>今天我們要來了解 JavaScript 在建立執行環境時做了什麼。</p>
<h2 id="提升-Hoisiting"><a href="#提升-Hoisiting" class="headerlink" title="提升 (Hoisiting)"></a>提升 (Hoisiting)</h2><p>首先我們來做在別的程式語言沒辦法做到，但在 JavaScript 中卻能辦到的行為，以下是今天的範例程式碼。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> b = <span class="string">"Called b"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Called function a'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">a();</span><br><span class="line"><span class="built_in">console</span>.log(b);</span><br><span class="line"></span><br><span class="line"><span class="comment">// console.log(...) 可以將 (...) 裡面的程式碼顯示在 Console 視窗中</span></span><br><span class="line"><span class="comment">// a() 是呼叫 function a 執行</span></span><br></pre></td></tr></table></figure>

<p>我們把 <code>a()</code> 和 <code>console.log(b)</code> 移到程式的最上方，觀察 Console 視窗會出現什麼結果。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a();</span><br><span class="line"><span class="built_in">console</span>.log(b);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = <span class="string">"Called b"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Called function a'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一般而言，在別的程式語言這樣做會產生錯誤，因為在執行時，變數 b 還尚未宣告，所以會出現錯誤，但在 JavaScript 中，會顯示 <code>Called function a</code> 和 <code>undefined</code>，神奇的是，竟然沒有產生任何錯誤。</p>
<p>透過這個例子，我們了解到，當 JavaScript 執行時，即使在 function 前面呼叫，function 仍會執行，而變數也會執行，只是它得到的結果是 <code>undefined</code>。</p>
<blockquote>
<p><strong>這種將尚未宣告的 function 或變數移到前方執行，程式仍可運作的現象，我們稱做 提升 (Hoisiting)。</strong></p>
</blockquote>
<p>補充：如果我們移除 function a 或變數 b，執行時會出現 <code>a is not defined</code> 或是 <code>b is not defined</code> 的錯誤。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// error: a is not defined</span></span><br><span class="line">a();</span><br><span class="line"><span class="built_in">console</span>.log(b);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = <span class="string">"Called b"</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a();</span><br><span class="line"><span class="comment">// error: b is not defined</span></span><br><span class="line"><span class="built_in">console</span>.log(b);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Called function a'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="如何產生提升-Hoisiting"><a href="#如何產生提升-Hoisiting" class="headerlink" title="如何產生提升 (Hoisiting) ?"></a>如何產生提升 (Hoisiting) ?</h2><p>現在有了 提升 (Hoisiting) 的概念後，我們來了解它是如何產生的。</p>
<p>JavaScript 這種沒有先宣告，就能取用的情況，是因為執行環境分為<strong>創造階段 (Creation Phase)</strong>和<strong>執行階段 (Execution Phase)</strong></p>
<h4 id="創造階段-Creation-Phase"><a href="#創造階段-Creation-Phase" class="headerlink" title="創造階段 (Creation Phase)"></a>創造階段 (Creation Phase)</h4><p>在這個階段，會建立：</p>
<ul>
<li>全域物件</li>
<li>this 變數</li>
<li>外部環境</li>
<li>你的程式碼 (正在被轉換)</li>
</ul>
<p>你的程式碼在這個階段會透過語法解析器轉換，它會知道你在哪裡建立變數和 function，並設定到記憶體中，而這個步驟就叫 提升 (Hoisiting)。</p>
<p>也就是說，在執行程式碼前，JavaScript 引擎已經為變數和 function 建立空間給它們，所以在這個階段它們已經存在於記憶體中，因此在逐行執行時，便能找到變數和 function。</p>
<p>我們從上面的範例可以知道，function 已經全部被設定在記憶體中，因此我們能直接取用，然而，變數的情況卻有些不同，變數會透過 <code>=</code> 來賦予值，但這要在執行階段才會賦予，因此<strong>在創造階段會先賦予 <code>undefined</code> 作為值的替代</strong>。</p>
<p>補充：<code>undefined</code>表示<strong>我還不知道它的值是什麼</strong>，如果我一開始沒有設值給變數，也會得到一樣的結果，這也代表<strong>所有的 JavaScript 變數一開始都會被設定為 <code>undefined</code></strong>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> c;</span><br><span class="line"><span class="built_in">console</span>.log(c); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>

<p>然而，依賴提升 (Hoisiting) 並非一件好事，這可能會造成程式執行上的錯誤，以下方的例子來說，假設我要透過 console.log 查看 d 的值，但由於提升的特性，會顯示 <code>undefined</code>，並不會顯示 <code>Called d</code>，所以寫程式時，我們<strong>要盡量把變數和 function 寫在最上面</strong>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(d); </span><br><span class="line"><span class="keyword">var</span> d = <span class="string">'Called d'</span>;</span><br></pre></td></tr></table></figure>

<h4 id="執行階段-Execution-Phase"><a href="#執行階段-Execution-Phase" class="headerlink" title="執行階段 (Execution Phase)"></a>執行階段 (Execution Phase)</h4><p>執行階段 (Execution Phase) 會逐行執行程式碼，在這個階段，會透過 <code>=</code> 賦予值給變數。</p>

            </div>
        </div>
    </article>

    
    
<nav class="article-nav">
  
  
    <a href="/JavaScript/2019/10/07/global_environment&object/" id="article-nav-older" class="article-nav-link-wrap next">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">全域執行環境和全域物件</div>
    </a>
  
</nav>

    

    
    <section id="comments" class="article-comments">
        <div id="disqus_thread"></div>
        <script>
        
        /**
        *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
        *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
        /*
        var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };
        */
        (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://https-apeiros0-github-io.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
        })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </section>
    
</div>
    </div>
    <footer class="site-footer">
        <div class="global-width">
            <ul class="site-widget">
                
                <li class="widget widget-tag">
                    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget-body">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/克服-JavaScript-奇怪部分筆記/">克服 JavaScript 奇怪部分筆記</a><span class="tag-list-count">4</span></li></ul>
    </div>
  </div>

                </li>
                
                <li class="widget widget-category">
                    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

                </li>
                
                <li class="widget widget-recent_posts">
                    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget-body">
      <ul>
        
          <li>
            <a href="/JavaScript/2019/10/08/creation_and_hoisiting/">創造和提升 (Hoisiting)</a>
          </li>
        
          <li>
            <a href="/JavaScript/2019/10/07/global_environment&object/">全域執行環境和全域物件</a>
          </li>
        
          <li>
            <a href="/JavaScript/2019/10/06/name_value_pairs_and_object/">Name/Value 配對和物件</a>
          </li>
        
          <li>
            <a href="/JavaScript/2019/10/04/execution&lexical-environment/">語法解析器、執行環境與詞彙環境</a>
          </li>
        
      </ul>
    </div>
  </div>

                </li>
                
            </ul>
        </div>
        <div class="site-info">
            <address>
                &copy; 2019 <a href="https://apeiros0.github.io">apeiros0 Blog</a> All Right Reserved. <br>
                Powered by <a href="http://hexo.io">Hexo</a>. Theme by <a href="http://zzoman.com">ZZOMAN</a>
            </address>
        </div>
    </footer>
    
    <script src="/libs/jquery-1.11.3.min.js" type="text/javascript"></script>
    
    <script src="/libs/fancybox/jquery.fancybox.js" type="text/javascript"></script>
    
    <script src="/js/site_init.js" type="text/javascript"></script>
    <!--  -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-149403450-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-149403450-1');
    </script>
    
</body>
</html>